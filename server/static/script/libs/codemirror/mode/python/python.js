!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../codemirror")):"function"==typeof define&&define.amd?define(["../../codemirror"],a):a(CodeMirror)}(function(a){"use strict";a.defineMode("python",function(b,c){function e(a){return new RegExp("^(("+a.join(")|(")+"))\\b")}function v(a,b){if(a.sol()){var c=b.scopes[0].offset;if(a.eatSpace()){var e=a.indentation();return e>c?u="indent":c>e&&(u="dedent"),null}c>0&&y(a,b)}if(a.eatSpace())return null;var l=a.peek();if("#"===l)return a.skipToEnd(),"comment";if(a.match(/^[0-9\.]/,!1)){var n=!1;if(a.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(n=!0),a.match(/^\d+\.\d*/)&&(n=!0),a.match(/^\.\d+/)&&(n=!0),n)return a.eat(/J/i),"number";var o=!1;if(a.match(/^0x[0-9a-f]+/i)&&(o=!0),a.match(/^0b[01]+/i)&&(o=!0),a.match(/^0o[0-7]+/i)&&(o=!0),a.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(a.eat(/J/i),o=!0),a.match(/^0(?![\dx])/i)&&(o=!0),o)return a.eat(/L/i),"number"}return a.match(r)?(b.tokenize=w(a.current()),b.tokenize(a,b)):a.match(j)||a.match(i)?null:a.match(h)||a.match(f)||a.match(m)?"operator":a.match(g)?null:a.match(s)?"keyword":a.match(t)?"builtin":a.match(/^(self|cls)\b/)?"variable-2":a.match(k)?"def"==b.lastToken||"class"==b.lastToken?"def":"variable":(a.next(),d)}function w(a){function f(f,g){for(;!f.eol();)if(f.eatWhile(/[^'"\\]/),f.eat("\\")){if(f.next(),b&&f.eol())return e}else{if(f.match(a))return g.tokenize=v,e;f.eat(/['"]/)}if(b){if(c.singleLineStringErrors)return d;g.tokenize=v}return e}for(;"rub".indexOf(a.charAt(0).toLowerCase())>=0;)a=a.substr(1);var b=1==a.length,e="string";return f.isString=!0,f}function x(a,c,d){d=d||"py";var e=0;if("py"===d){if("py"!==c.scopes[0].type)return c.scopes[0].offset=a.indentation(),void 0;for(var f=0;f<c.scopes.length;++f)if("py"===c.scopes[f].type){e=c.scopes[f].offset+b.indentUnit;break}}else e=a.match(/\s*($|#)/,!1)?a.indentation()+l:a.column()+a.current().length;c.scopes.unshift({offset:e,type:d})}function y(a,b,c){if(c=c||"py",1!=b.scopes.length){if("py"===b.scopes[0].type){for(var d=a.indentation(),e=-1,f=0;f<b.scopes.length;++f)if(d===b.scopes[f].offset){e=f;break}if(-1===e)return!0;for(;b.scopes[0].offset!==d;)b.scopes.shift();return!1}return"py"===c?(b.scopes[0].offset=a.indentation(),!1):b.scopes[0].type!=c?!0:(b.scopes.shift(),!1)}}function z(a,b){u=null;var c=b.tokenize(a,b),e=a.current();if("."===e)return c=a.match(k,!1)?null:d,null===c&&"meta"===b.lastStyle&&(c="meta"),c;if("@"===e)return a.match(k,!1)?"meta":d;"variable"!==c&&"builtin"!==c||"meta"!==b.lastStyle||(c="meta"),("pass"===e||"return"===e)&&(b.dedent+=1),"lambda"===e&&(b.lambda=!0),(":"===e&&!b.lambda&&"py"==b.scopes[0].type||"indent"===u)&&x(a,b);var f="[({".indexOf(e);return-1!==f&&x(a,b,"])}".slice(f,f+1)),"dedent"===u&&y(a,b)?d:(f="])}".indexOf(e),-1!==f&&y(a,b,e)?d:(b.dedent>0&&a.eol()&&"py"==b.scopes[0].type&&(b.scopes.length>1&&b.scopes.shift(),b.dedent-=1),c))}var d="error",f=c.singleOperators||new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"),g=c.singleDelimiters||new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),h=c.doubleOperators||new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),i=c.doubleDelimiters||new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),j=c.tripleDelimiters||new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))"),k=c.identifiers||new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),l=c.hangingIndent||c.indentUnit,m=e(["and","or","not","is","in"]),n=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield"],o=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"],p={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]},q={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None"]};if(void 0!=c.extra_keywords&&(n=n.concat(c.extra_keywords)),void 0!=c.extra_builtins&&(o=o.concat(c.extra_builtins)),c.version&&3===parseInt(c.version,10)){n=n.concat(q.keywords),o=o.concat(q.builtins);var r=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}else{n=n.concat(p.keywords),o=o.concat(p.builtins);var r=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var s=e(n),t=e(o),u=null,A={startState:function(a){return{tokenize:v,scopes:[{offset:a||0,type:"py"}],lastStyle:null,lastToken:null,lambda:!1,dedent:0}},token:function(a,b){var c=z(a,b);b.lastStyle=c;var d=a.current();return d&&c&&(b.lastToken=d),a.eol()&&b.lambda&&(b.lambda=!1),c},indent:function(b){return b.tokenize!=v?b.tokenize.isString?a.Pass:0:b.scopes[0].offset},lineComment:"#",fold:"indent"};return A}),a.defineMIME("text/x-python","python");var b=function(a){return a.split(" ")};a.defineMIME("text/x-cython",{name:"python",extra_keywords:b("by cdef cimport cpdef ctypedef enum exceptextern gil include nogil property publicreadonly struct union DEF IF ELIF ELSE")})});